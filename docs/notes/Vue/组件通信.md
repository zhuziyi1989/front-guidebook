# Vueä¸­8ç§ç»„ä»¶é€šä¿¡æ–¹å¼

ğŸ‡ ä¹‹å‰å†™äº†ä¸€ç¯‡å…³äºvueé¢è¯•æ€»ç»“çš„æ–‡ç« , æœ‰ä¸å°‘ç½‘å‹æå‡ºç»„ä»¶ä¹‹é—´é€šä¿¡æ–¹å¼è¿˜æœ‰å¾ˆå¤š, è¿™ç¯‡æ–‡ç« ä¾¿æ˜¯ä¸“é—¨æ€»ç»“ç»„ä»¶ä¹‹é—´é€šä¿¡çš„

vueæ˜¯æ•°æ®é©±åŠ¨è§†å›¾æ›´æ–°çš„æ¡†æ¶, æ‰€ä»¥å¯¹äºvueæ¥è¯´ç»„ä»¶é—´çš„æ•°æ®é€šä¿¡éå¸¸é‡è¦ï¼Œé‚£ä¹ˆç»„ä»¶ä¹‹é—´å¦‚ä½•è¿›è¡Œæ•°æ®é€šä¿¡çš„å‘¢ï¼Ÿ
é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨vueä¸­ç»„ä»¶ä¹‹é—´å­˜åœ¨ä»€ä¹ˆæ ·çš„å…³ç³», æ‰æ›´å®¹æ˜“ç†è§£ä»–ä»¬çš„é€šä¿¡æ–¹å¼, å°±å¥½åƒè¿‡å¹´å›å®¶ï¼Œåç€ä¸€å±‹å­çš„é™Œç”Ÿäººï¼Œç›¸äº’ä¹‹é—´æ€ä¹ˆç§°å‘¼ï¼Œè¿™æ—¶å°±éœ€è¦å…ˆçŸ¥é“è‡ªå·±å’Œä»–ä»¬ä¹‹é—´æ˜¯ä»€ä¹ˆæ ·çš„å…³ç³»ã€‚
vueç»„ä»¶ä¸­å…³ç³»è¯´æ˜:
![image](http://img.xiaogangzai.cn/16bde5b613aac4ee.jpg)

å¦‚ä¸Šå›¾æ‰€ç¤º, Aä¸Bã€Aä¸Cã€Bä¸Dã€Cä¸Eç»„ä»¶ä¹‹é—´æ˜¯çˆ¶å­å…³ç³»ï¼› Bä¸Cä¹‹é—´æ˜¯å…„å¼Ÿå…³ç³»ï¼›Aä¸Dã€Aä¸Eä¹‹é—´æ˜¯éš”ä»£å…³ç³»ï¼› Dä¸Eæ˜¯å ‚å…„å…³ç³»ï¼ˆéç›´ç³»äº²å±ï¼‰
é’ˆå¯¹ä»¥ä¸Šå…³ç³»æˆ‘ä»¬å½’ç±»ä¸ºï¼š

- çˆ¶å­ç»„ä»¶ä¹‹é—´é€šä¿¡
- éçˆ¶å­ç»„ä»¶ä¹‹é—´é€šä¿¡(å…„å¼Ÿç»„ä»¶ã€éš”ä»£å…³ç³»ç»„ä»¶ç­‰)

æœ¬æ–‡ä¼šä»‹ç»ç»„ä»¶é—´é€šä¿¡çš„8ç§æ–¹å¼å¦‚ä¸‹å›¾ç›®å½•æ‰€ç¤º:å¹¶ä»‹ç»åœ¨ä¸åŒçš„åœºæ™¯ä¸‹å¦‚ä½•é€‰æ‹©æœ‰æ•ˆæ–¹å¼å®ç°çš„ç»„ä»¶é—´é€šä¿¡æ–¹å¼ï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©å°ä¼™ä¼´ä»¬æ›´å¥½ç†è§£ç»„ä»¶é—´çš„é€šä¿¡ã€‚

## ä¸€ã€`props` / `$emit`

çˆ¶ç»„ä»¶é€šè¿‡`props`çš„æ–¹å¼å‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œè€Œé€šè¿‡`$emit` å­ç»„ä»¶å¯ä»¥å‘çˆ¶ç»„ä»¶é€šä¿¡ã€‚

### 1. çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ å€¼

ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­è¯´æ˜çˆ¶ç»„ä»¶å¦‚ä½•å‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼šåœ¨å­ç»„ä»¶`article.vue`ä¸­å¦‚ä½•è·å–çˆ¶ç»„ä»¶`section.vue`ä¸­çš„æ•°æ®`articles:['çº¢æ¥¼æ¢¦', 'è¥¿æ¸¸è®°','ä¸‰å›½æ¼”ä¹‰']`

```html
// sectionçˆ¶ç»„ä»¶
<template>
  <div class="section">
    <com-article :articles="articleList"></com-article>
  </div>
</template>

<script>
import comArticle from './test/article.vue'
export default {
  name: 'HelloWorld',
  components: { comArticle },
  data() {
    return {
      articleList: ['çº¢æ¥¼æ¢¦', 'è¥¿æ¸¸è®°', 'ä¸‰å›½æ¼”ä¹‰']
    }
  }
}
</script>

```

```html
// å­ç»„ä»¶ article.vue
<template>
  <div>
    <span v-for="(item, index) in articles" :key="index">{{item}}</span>
  </div>
</template>

<script>
export default {
  props: ['articles']
}
</script>
```

> æ€»ç»“: prop åªå¯ä»¥ä»ä¸Šä¸€çº§ç»„ä»¶ä¼ é€’åˆ°ä¸‹ä¸€çº§ç»„ä»¶ï¼ˆçˆ¶å­ç»„ä»¶ï¼‰ï¼Œå³æ‰€è°“çš„å•å‘æ•°æ®æµã€‚è€Œä¸” prop åªè¯»ï¼Œä¸å¯è¢«ä¿®æ”¹ï¼Œæ‰€æœ‰ä¿®æ”¹éƒ½ä¼šå¤±æ•ˆå¹¶è­¦å‘Šã€‚

### 2. å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ å€¼

å¯¹äº`$emit` æˆ‘è‡ªå·±çš„ç†è§£æ˜¯è¿™æ ·çš„: `$emit`ç»‘å®šä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶, å½“è¿™ä¸ªè¯­å¥è¢«æ‰§è¡Œæ—¶, å°±ä¼šå°†å‚æ•°argä¼ é€’ç»™çˆ¶ç»„ä»¶,çˆ¶ç»„ä»¶é€šè¿‡v-onç›‘å¬å¹¶æ¥æ”¶å‚æ•°ã€‚ é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œè¯´æ˜å­ç»„ä»¶å¦‚ä½•å‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®ã€‚
åœ¨ä¸Šä¸ªä¾‹å­çš„åŸºç¡€ä¸Š, ç‚¹å‡»é¡µé¢æ¸²æŸ“å‡ºæ¥çš„`ariticle`çš„`item`, çˆ¶ç»„ä»¶ä¸­æ˜¾ç¤ºåœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡

```html
// çˆ¶ç»„ä»¶ä¸­
<template>
  <div class="section">
    <com-article :articles="articleList" @onEmitIndex="onEmitIndex"></com-article>
    <p>{{currentIndex}}</p>
  </div>
</template>

<script>
import comArticle from './test/article.vue'
export default {
  name: 'HelloWorld',
  components: { comArticle },
  data() {
    return {
      currentIndex: -1,
      articleList: ['çº¢æ¥¼æ¢¦', 'è¥¿æ¸¸è®°', 'ä¸‰å›½æ¼”ä¹‰']
    }
  },
  methods: {
    onEmitIndex(idx) {
      this.currentIndex = idx
    }
  }
}
</script>
```

```html
<template>
  <div>
    <div v-for="(item, index) in articles" :key="index" @click="emitIndex(index)">{{item}}</div>
  </div>
</template>

<script>
export default {
  props: ['articles'],
  methods: {
    emitIndex(index) {
      this.$emit('onEmitIndex', index)
    }
  }
}
</script>
```

## äºŒã€  `$children` / `$parent`

![image](http://img.xiaogangzai.cn/vueMessage_20200718_1.jpg)
ä¸Šé¢è¿™å¼ å›¾ç‰‡æ˜¯`vue`å®˜æ–¹çš„è§£é‡Šï¼Œé€šè¿‡`$parent`å’Œ`$children`å°±å¯ä»¥è®¿é—®ç»„ä»¶çš„å®ä¾‹ï¼Œæ‹¿åˆ°å®ä¾‹ä»£è¡¨ä»€ä¹ˆï¼Ÿä»£è¡¨å¯ä»¥è®¿é—®æ­¤ç»„ä»¶çš„æ‰€æœ‰æ–¹æ³•å’Œ`data`ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ€ä¹ˆå®ç°æ‹¿åˆ°æŒ‡å®šç»„ä»¶çš„å®ä¾‹ã€‚

### ä½¿ç”¨æ–¹æ³•

```html
// çˆ¶ç»„ä»¶ä¸­
<template>
  <div class="hello_world">
    <div>{{msg}}</div>
    <com-a></com-a>
    <button @click="changeA">ç‚¹å‡»æ”¹å˜å­ç»„ä»¶å€¼</button>
  </div>
</template>

<script>
import ComA from './test/comA.vue'
export default {
  name: 'HelloWorld',
  components: { ComA },
  data() {
    return {
      msg: 'Welcome'
    }
  },

  methods: {
    changeA() {
      // è·å–åˆ°å­ç»„ä»¶A
      this.$children[0].messageA = 'this is new value'
    }
  }
}
</script>
```

```html
// å­ç»„ä»¶ä¸­
<template>
  <div class="com_a">
    <span>{{messageA}}</span>
    <p>è·å–çˆ¶ç»„ä»¶çš„å€¼ä¸º:  {{parentVal}}</p>
  </div>
</template>

<script>
export default {
  data() {
    return {
      messageA: 'this is old'
    }
  },
  computed:{
    parentVal(){
      return this.$parent.msg;
    }
  }
}
</script>
```

>è¦æ³¨æ„è¾¹ç•Œæƒ…å†µï¼Œå¦‚åœ¨`#app`ä¸Šæ‹¿`$parent`å¾—åˆ°çš„æ˜¯`new Vue()`çš„å®ä¾‹ï¼Œåœ¨è¿™å®ä¾‹ä¸Šå†æ‹¿`$parent`å¾—åˆ°çš„æ˜¯`undefined`ï¼Œè€Œåœ¨æœ€åº•å±‚çš„å­ç»„ä»¶æ‹¿`$children`æ˜¯ä¸ªç©ºæ•°ç»„ã€‚ä¹Ÿè¦æ³¨æ„å¾—åˆ°`$parent`å’Œ`$children`çš„å€¼ä¸ä¸€æ ·ï¼Œ`$children` çš„å€¼æ˜¯æ•°ç»„ï¼Œè€Œ`$parent`æ˜¯ä¸ªå¯¹è±¡

#### æ€»ç»“

ä¸Šé¢ä¸¤ç§æ–¹å¼ç”¨äºçˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ï¼Œ è€Œä½¿ç”¨propsè¿›è¡Œçˆ¶å­ç»„ä»¶é€šä¿¡æ›´åŠ æ™®é; äºŒè€…çš†ä¸èƒ½ç”¨äºéçˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ã€‚

## ä¸‰ã€`provide`/ `inject`

### æ¦‚å¿µ

`provide`/ `inject` æ˜¯`vue2.2.0`æ–°å¢çš„api, ç®€å•æ¥è¯´å°±æ˜¯çˆ¶ç»„ä»¶ä¸­é€šè¿‡`provide`æ¥æä¾›å˜é‡, ç„¶åå†å­ç»„ä»¶ä¸­é€šè¿‡`inject`æ¥æ³¨å…¥å˜é‡ã€‚
> æ³¨æ„: è¿™é‡Œä¸è®ºå­ç»„ä»¶åµŒå¥—æœ‰å¤šæ·±, åªè¦è°ƒç”¨äº†`inject` é‚£ä¹ˆå°±å¯ä»¥æ³¨å…¥`provide`ä¸­çš„æ•°æ®ï¼Œè€Œä¸å±€é™äºåªèƒ½ä»å½“å‰çˆ¶ç»„ä»¶çš„propså±æ€§ä¸­å›å»æ•°æ®

### ä¸¾ä¾‹éªŒè¯

æ¥ä¸‹æ¥å°±ç”¨ä¸€ä¸ªä¾‹å­æ¥éªŒè¯ä¸Šé¢çš„æè¿°:
å‡è®¾æœ‰ä¸‰ä¸ªç»„ä»¶: A.vueã€B.vueã€C.vue å…¶ä¸­ Cæ˜¯Bçš„å­ç»„ä»¶ï¼ŒBæ˜¯Açš„å­ç»„ä»¶

```html
// A.vue

<template>
  <div>
 <comB></comB>
  </div>
</template>

<script>
  import comB from '../components/test/comB.vue'
  export default {
    name: "A",
    provide: {
      for: "demo"
    },
    components:{
      comB
    }
  }
</script>
```

```html
// B.vue

<template>
  <div>
    {{demo}}
    <comC></comC>
  </div>
</template>

<script>
  import comC from '../components/test/comC.vue'
  export default {
    name: "B",
    inject: ['for'],
    data() {
      return {
        demo: this.for
      }
    },
    components: {
      comC
    }
  }
</script>
```

```html
// C.vue
<template>
  <div>
    {{demo}}
  </div>
</template>

<script>
  export default {
    name: "C",
    inject: ['for'],
    data() {
      return {
        demo: this.for
      }
    }
  }
</script>
```

## å››ã€`ref` / `refs`

`ref`ï¼šå¦‚æœåœ¨æ™®é€šçš„ DOM å…ƒç´ ä¸Šä½¿ç”¨ï¼Œå¼•ç”¨æŒ‡å‘çš„å°±æ˜¯ DOM å…ƒç´ ï¼›å¦‚æœç”¨åœ¨å­ç»„ä»¶ä¸Šï¼Œå¼•ç”¨å°±æŒ‡å‘ç»„ä»¶å®ä¾‹ï¼Œå¯ä»¥é€šè¿‡å®ä¾‹ç›´æ¥è°ƒç”¨ç»„ä»¶çš„æ–¹æ³•æˆ–è®¿é—®æ•°æ®ï¼Œ æˆ‘ä»¬çœ‹ä¸€ä¸ª`ref` æ¥è®¿é—®ç»„ä»¶çš„ä¾‹å­:

```javascript
// å­ç»„ä»¶ A.vue

export default {
  data () {
    return {
      name: 'Vue.js'
    }
  },
  methods: {
    sayHello () {
      console.log('hello')
    }
  }
}
```

```javascript
// çˆ¶ç»„ä»¶ app.vue

<template>
  <component-a ref="comA"></component-a>
</template>
<script>
  export default {
    mounted () {
      const comA = this.$refs.comA;
      console.log(comA.name);  // Vue.js
      comA.sayHello();  // hello
    }
  }
</script>
```

## äº”ã€eventBus

`eventBus`  åˆç§°ä¸ºäº‹ä»¶æ€»çº¿ï¼Œåœ¨vueä¸­å¯ä»¥ä½¿ç”¨å®ƒæ¥ä½œä¸ºæ²Ÿé€šæ¡¥æ¢çš„æ¦‚å¿µ, å°±åƒæ˜¯æ‰€æœ‰ç»„ä»¶å…±ç”¨ç›¸åŒçš„äº‹ä»¶ä¸­å¿ƒï¼Œå¯ä»¥å‘è¯¥ä¸­å¿ƒæ³¨å†Œå‘é€äº‹ä»¶æˆ–æ¥æ”¶äº‹ä»¶ï¼Œ æ‰€ä»¥ç»„ä»¶éƒ½å¯ä»¥é€šçŸ¥å…¶ä»–ç»„ä»¶ã€‚
> eventBusä¹Ÿæœ‰ä¸æ–¹ä¾¿ä¹‹å¤„, å½“é¡¹ç›®è¾ƒå¤§,å°±å®¹æ˜“é€ æˆéš¾ä»¥ç»´æŠ¤çš„ç¾éš¾

åœ¨Vueçš„é¡¹ç›®ä¸­æ€ä¹ˆä½¿ç”¨`eventBus`æ¥å®ç°ç»„ä»¶ä¹‹é—´çš„æ•°æ®é€šä¿¡å‘¢?å…·ä½“é€šè¿‡ä¸‹é¢å‡ ä¸ªæ­¥éª¤

### 1. åˆå§‹åŒ–

é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªäº‹ä»¶æ€»çº¿å¹¶å°†å…¶å¯¼å‡º, ä»¥ä¾¿å…¶ä»–æ¨¡å—å¯ä»¥ä½¿ç”¨æˆ–è€…ç›‘å¬å®ƒ.

```javascript
// event-bus.js

import Vue from 'vue'
export const EventBus = new Vue()
```

#### 2. å‘é€äº‹ä»¶

å‡è®¾ä½ æœ‰ä¸¤ä¸ªç»„ä»¶: `additionNum` å’Œ `showNum`, è¿™ä¸¤ä¸ªç»„ä»¶å¯ä»¥æ˜¯å…„å¼Ÿç»„ä»¶ä¹Ÿå¯ä»¥æ˜¯çˆ¶å­ç»„ä»¶ï¼›è¿™é‡Œæˆ‘ä»¬ä»¥å…„å¼Ÿç»„ä»¶ä¸ºä¾‹:

```html
<template>
  <div>
    <show-num-com></show-num-com>
    <addition-num-com></addition-num-com>
  </div>
</template>

<script>
import showNumCom from './showNum.vue'
import additionNumCom from './additionNum.vue'
export default {
  components: { showNumCom, additionNumCom }
}
</script>

```

```html
// addtionNum.vue ä¸­å‘é€äº‹ä»¶

<template>
  <div>
    <button @click="additionHandle">+åŠ æ³•å™¨</button>    
  </div>
</template>

<script>
import {EventBus} from './event-bus.js'
console.log(EventBus)
export default {
  data(){
    return{
      num:1
    }
  },

  methods:{
    additionHandle(){
      EventBus.$emit('addition', {
        num:this.num++
      })
    }
  }
}
</script>
```

#### 3. æ¥æ”¶äº‹ä»¶

```html
// showNum.vue ä¸­æ¥æ”¶äº‹ä»¶

<template>
  <div>è®¡ç®—å’Œ: {{count}}</div>
</template>

<script>
import { EventBus } from './event-bus.js'
export default {
  data() {
    return {
      count: 0
    }
  },

  mounted() {
    EventBus.$on('addition', param => {
      this.count = this.count + param.num;
    })
  }
}
</script>
```

è¿™æ ·å°±å®ç°äº†åœ¨ç»„ä»¶`addtionNum.vue`ä¸­ç‚¹å‡»ç›¸åŠ æŒ‰é’®, åœ¨`showNum.vue`ä¸­åˆ©ç”¨ä¼ é€’æ¥çš„ `num` å±•ç¤ºæ±‚å’Œçš„ç»“æœ.

#### 4. ç§»é™¤äº‹ä»¶ç›‘å¬è€…

å¦‚æœæƒ³ç§»é™¤äº‹ä»¶çš„ç›‘å¬, å¯ä»¥åƒä¸‹é¢è¿™æ ·æ“ä½œ:

```javascript
import { eventBus } from 'event-bus.js'
EventBus.$off('addition', {})
```

## å…­ã€Vuex

### 1.  Vuexä»‹ç»

Vuex æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ã€‚å®ƒé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶ä»¥ç›¸åº”çš„è§„åˆ™ä¿è¯çŠ¶æ€ä»¥ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–.
Vuex è§£å†³äº†`å¤šä¸ªè§†å›¾ä¾èµ–äºåŒä¸€çŠ¶æ€`å’Œ`æ¥è‡ªä¸åŒè§†å›¾çš„è¡Œä¸ºéœ€è¦å˜æ›´åŒä¸€çŠ¶æ€`çš„é—®é¢˜ï¼Œå°†å¼€å‘è€…çš„ç²¾åŠ›èšç„¦äºæ•°æ®çš„æ›´æ–°è€Œä¸æ˜¯æ•°æ®åœ¨ç»„ä»¶ä¹‹é—´çš„ä¼ é€’ä¸Š

### 2. Vuexå„ä¸ªæ¨¡å—

1. `state`ï¼šç”¨äºæ•°æ®çš„å­˜å‚¨ï¼Œæ˜¯storeä¸­çš„å”¯ä¸€æ•°æ®æº
2. `getters`ï¼šå¦‚vueä¸­çš„è®¡ç®—å±æ€§ä¸€æ ·ï¼ŒåŸºäºstateæ•°æ®çš„äºŒæ¬¡åŒ…è£…ï¼Œå¸¸ç”¨äºæ•°æ®çš„ç­›é€‰å’Œå¤šä¸ªæ•°æ®çš„ç›¸å…³æ€§è®¡ç®—
3. `mutations`ï¼šç±»ä¼¼å‡½æ•°ï¼Œæ”¹å˜stateæ•°æ®çš„å”¯ä¸€é€”å¾„ï¼Œä¸”ä¸èƒ½ç”¨äºå¤„ç†å¼‚æ­¥äº‹ä»¶
4. `actions`ï¼šç±»ä¼¼äº`mutation`ï¼Œç”¨äºæäº¤`mutation`æ¥æ”¹å˜çŠ¶æ€ï¼Œè€Œä¸ç›´æ¥å˜æ›´çŠ¶æ€ï¼Œå¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œ
5. `modules`ï¼šç±»ä¼¼äºå‘½åç©ºé—´ï¼Œç”¨äºé¡¹ç›®ä¸­å°†å„ä¸ªæ¨¡å—çš„çŠ¶æ€åˆ†å¼€å®šä¹‰å’Œæ“ä½œï¼Œä¾¿äºç»´æŠ¤

### 3. Vuexå®ä¾‹åº”ç”¨

```html
// çˆ¶ç»„ä»¶

<template>
  <div id="app">
    <ChildA/>
    <ChildB/>
  </div>
</template>

<script>
  import ChildA from './components/ChildA' // å¯¼å…¥Aç»„ä»¶
  import ChildB from './components/ChildB' // å¯¼å…¥Bç»„ä»¶

  export default {
    name: 'App',
    components: {ChildA, ChildB} // æ³¨å†ŒAã€Bç»„ä»¶
  }
</script>
```

```html
// å­ç»„ä»¶childA

<template>
  <div id="childA">
    <h1>æˆ‘æ˜¯Aç»„ä»¶</h1>
    <button @click="transform">ç‚¹æˆ‘è®©Bç»„ä»¶æ¥æ”¶åˆ°æ•°æ®</button>
    <p>å› ä¸ºä½ ç‚¹äº†Bï¼Œæ‰€ä»¥æˆ‘çš„ä¿¡æ¯å‘ç”Ÿäº†å˜åŒ–ï¼š{{BMessage}}</p>
  </div>
</template>

<script>
  export default {
    data() {
      return {
        AMessage: 'Helloï¼ŒBç»„ä»¶ï¼Œæˆ‘æ˜¯Aç»„ä»¶'
      }
    },
    computed: {
      BMessage() {
        // è¿™é‡Œå­˜å‚¨ä»storeé‡Œè·å–çš„Bç»„ä»¶çš„æ•°æ®
        return this.$store.state.BMsg
      }
    },
    methods: {
      transform() {
        // è§¦å‘receiveAMsgï¼Œå°†Aç»„ä»¶çš„æ•°æ®å­˜æ”¾åˆ°storeé‡Œå»
        this.$store.commit('receiveAMsg', {
          AMsg: this.AMessage
        })
      }
    }
  }
</script>
```

```html
// å­ç»„ä»¶ childB

<template>
  <div id="childB">
    <h1>æˆ‘æ˜¯Bç»„ä»¶</h1>
    <button @click="transform">ç‚¹æˆ‘è®©Aç»„ä»¶æ¥æ”¶åˆ°æ•°æ®</button>
    <p>å› ä¸ºä½ ç‚¹äº†Aï¼Œæ‰€ä»¥æˆ‘çš„ä¿¡æ¯å‘ç”Ÿäº†å˜åŒ–ï¼š{{AMessage}}</p>
  </div>
</template>

<script>
  export default {
    data() {
      return {
        BMessage: 'Helloï¼ŒAç»„ä»¶ï¼Œæˆ‘æ˜¯Bç»„ä»¶'
      }
    },
    computed: {
      AMessage() {
        // è¿™é‡Œå­˜å‚¨ä»storeé‡Œè·å–çš„Aç»„ä»¶çš„æ•°æ®
        return this.$store.state.AMsg
      }
    },
    methods: {
      transform() {
        // è§¦å‘receiveBMsgï¼Œå°†Bç»„ä»¶çš„æ•°æ®å­˜æ”¾åˆ°storeé‡Œå»
        this.$store.commit('receiveBMsg', {
          BMsg: this.BMessage
        })
      }
    }
  }
</script>
```

vuexçš„`store,js`

```javascript
import Vue from 'vue'
import Vuex from 'vuex'
Vue.use(Vuex)
const state = {
  // åˆå§‹åŒ–Aå’ŒBç»„ä»¶çš„æ•°æ®ï¼Œç­‰å¾…è·å–
  AMsg: '',
  BMsg: ''
}

const mutations = {
  receiveAMsg(state, payload) {
    // å°†Aç»„ä»¶çš„æ•°æ®å­˜æ”¾äºstate
    state.AMsg = payload.AMsg
  },
  receiveBMsg(state, payload) {
    // å°†Bç»„ä»¶çš„æ•°æ®å­˜æ”¾äºstate
    state.BMsg = payload.BMsg
  }
}

export default new Vuex.Store({
  state,
  mutations
})
```

## ä¸ƒã€ localStorageç­‰

è¿™ç§é€šä¿¡æ¯”è¾ƒç®€å•,ç¼ºç‚¹æ˜¯æ•°æ®å’ŒçŠ¶æ€æ¯”è¾ƒæ··ä¹±,ä¸å¤ªå®¹æ˜“ç»´æŠ¤ã€‚
é€šè¿‡`window.localStorage.getItem(key)`è·å–æ•°æ®
é€šè¿‡`window.localStorage.setItem(key,value)`å­˜å‚¨æ•°æ®
> æ³¨æ„ç”¨`JSON.parse()` / `JSON.stringify()` åšæ•°æ®æ ¼å¼è½¬æ¢
> `localStorage` / `sessionStorage`å¯ä»¥ç»“åˆ`vuex`, å®ç°æ•°æ®çš„æŒä¹…ä¿å­˜,åŒæ—¶ä½¿ç”¨vuexè§£å†³æ•°æ®å’ŒçŠ¶æ€æ··ä¹±é—®é¢˜.

## å…«ã€$attrsä¸ $listeners

ç°åœ¨æˆ‘ä»¬æ¥è®¨è®ºä¸€ç§æƒ…å†µï¼Œ æˆ‘ä»¬ä¸€å¼€å§‹ç»™å‡ºçš„ç»„ä»¶å…³ç³»å›¾ä¸­Aç»„ä»¶ä¸Dç»„ä»¶æ˜¯éš”ä»£å…³ç³»ï¼Œ é‚£å®ƒä»¬ä¹‹å‰è¿›è¡Œé€šä¿¡æœ‰å“ªäº›æ–¹å¼å‘¢ï¼Ÿ

1. ä½¿ç”¨`props`ç»‘å®šæ¥è¿›è¡Œä¸€çº§ä¸€çº§çš„ä¿¡æ¯ä¼ é€’, å¦‚æœDç»„ä»¶ä¸­çŠ¶æ€æ”¹å˜éœ€è¦ä¼ é€’æ•°æ®ç»™A, ä½¿ç”¨äº‹ä»¶ç³»ç»Ÿä¸€çº§çº§å¾€ä¸Šä¼ é€’
2. ä½¿ç”¨`eventBus`,è¿™ç§æƒ…å†µä¸‹è¿˜æ˜¯æ¯”è¾ƒé€‚åˆä½¿ç”¨, ä½†æ˜¯ç¢°åˆ°å¤šäººåˆä½œå¼€å‘æ—¶, ä»£ç ç»´æŠ¤æ€§è¾ƒä½, å¯è¯»æ€§ä¹Ÿä½
3. ä½¿ç”¨Vuexæ¥è¿›è¡Œæ•°æ®ç®¡ç†, ä½†æ˜¯å¦‚æœä»…ä»…æ˜¯ä¼ é€’æ•°æ®, è€Œä¸åšä¸­é—´å¤„ç†,ä½¿ç”¨Vuexå¤„ç†æ„Ÿè§‰æœ‰ç‚¹å¤§æå°ç”¨äº†.

åœ¨`vue2.4`ä¸­ï¼Œä¸ºäº†è§£å†³è¯¥éœ€æ±‚ï¼Œå¼•å…¥äº†`$attrs` å’Œ`$listeners` ï¼Œ æ–°å¢äº†`inheritAttrs` é€‰é¡¹ã€‚ åœ¨ç‰ˆæœ¬2.4ä»¥å‰ï¼Œé»˜è®¤æƒ…å†µä¸‹çˆ¶ä½œç”¨åŸŸçš„ä¸è¢«è®¤ä½œ`props`çš„å±æ€§ç™¾å¹´å­¤ç‹¬ï¼Œå°†ä¼šâ€œå›é€€â€ä¸”ä½œä¸ºæ™®é€šçš„HTMLç‰¹æ€§åº”ç”¨åœ¨å­ç»„ä»¶çš„æ ¹å…ƒç´ ä¸Šã€‚æ¥ä¸‹æ¥çœ‹ä¸€ä¸ªè·¨çº§é€šä¿¡çš„ä¾‹å­:

```html
// app.vue
// index.vue

<template>
  <div>
    <child-com1
      :name="name"
      :age="18"
      :gender="å¥³"
      :height="158"
      title="ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—"
    ></child-com1>
  </div>
</template>
<script>
const childCom1 = () => import("./childCom1.vue");
export default {
  components: { childCom1 },
  data() {
    return {
      name: "zhang",
      age: "18",
      gender: "å¥³",
      height: "158"
    };
  }
};
</script>
```

```html
// childCom1.vue

<template class="border">
  <div>
    <p>name: {{ name}}</p>
    <p>childCom1çš„$attrs: {{ $attrs }}</p>
    <child-com2 v-bind="$attrs"></child-com2>
  </div>
</template>
<script>
const childCom2 = () => import("./childCom2.vue");
export default {
  components: {
    childCom2
  },
  inheritAttrs: false, // å¯ä»¥å…³é—­è‡ªåŠ¨æŒ‚è½½åˆ°ç»„ä»¶æ ¹å…ƒç´ ä¸Šçš„æ²¡æœ‰åœ¨propså£°æ˜çš„å±æ€§
  props: {
    name: String // nameä½œä¸ºpropså±æ€§ç»‘å®š
  },
  created() {
    console.log(this.$attrs);
     // { "age": "18", "gender": "å¥³", "height": "158", "title": "ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—" }
  }
};
</script>
```

```html
// childCom2.vue

<template>
  <div class="border">
    <p>age: {{ age}}</p>
    <p>childCom2: {{ $attrs }}</p>
  </div>
</template>
<script>

export default {
  inheritAttrs: false,
  props: {
    age: String
  },
  created() {
    console.log(this.$attrs); 
    // { "name": "zhang", "gender": "å¥³", "height": "158", "title": "ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—" }
  }
};
</script>
```

## ä¹ã€æ€»ç»“

å¸¸è§ä½¿ç”¨åœºæ™¯å¯ä»¥åˆ†ä¸ºä¸‰ç±»:

- çˆ¶å­ç»„ä»¶é€šä¿¡: `props`; `$parent` / `$children`; `provide` / `inject` ; `ref` ;  `$attrs` / `$listeners`
- å…„å¼Ÿç»„ä»¶é€šä¿¡: `eventBus` ;  vuex
- è·¨çº§é€šä¿¡:  `eventBus`ï¼›Vuexï¼›`provide` / `inject` ã€`$attrs` / `$listeners`

ä»Šå¤©å°±åˆ†äº«è¿™ä¹ˆå¤šï¼Œå¦‚æœå¯¹åˆ†äº«çš„å†…å®¹æ„Ÿå…´è¶£ï¼Œå¯ä»¥å…³æ³¨å…¬ä¼—å·ã€Œç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—ã€ï¼Œæˆ–è€…åŠ å…¥æŠ€æœ¯äº¤æµç¾¤ï¼Œå¤§å®¶ä¸€èµ·è®¨è®ºã€‚

![way](http://img.xiaogangzai.cn/way.jpg)
